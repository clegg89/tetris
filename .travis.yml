language: cpp

sudo: required
dist: trusty

os:
  - linux

compiler:
  - gcc

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - cmake
      - libsfml-dev
      - libboost-filesystem-dev
      - cpputest
      - gcc-5
      - g++-5

env: C_COMPILER=gcc-5 CXX_COMPILER=g++-5

script:
    - mkdir build && cd build
    - cmake -DCMAKE_C_COMPILER=$C_COMPILER -DCMAKE_CXX_COMPILER=$CXX_COMPILER ..
    - cmake --build .
    - cd -

after_success:
    - cd build
    - ctest -V .
    - cpack -G "TGZ" .
    - cd -

deploy:
  provider: releases
  api_key:
  file: build/tetris*.tar.gz
  skip_cleanup: true
  on:
    branch: master
    tags: true
